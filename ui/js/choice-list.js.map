{"version":3,"sources":["../src/choice-list.js"],"names":["ChoiceList","options","choiceListId","id","choiceList","$","selectedChoices","choices","currentPage","active","choiceType","forEach","iter","proc","i","length","prototype","init","cb","callback","self","button","addEventListener","_buttonClickEventListener","e","buttons","document","querySelector","querySelectorAll","target","hasClass","_setupPager","_setupChoices","_deselectChoices","_toggleChoice","innerText","replaceChoices","availableChoices","reset","_choices","push","splice","targetPage","find","hide","show","prop","text","page","choiceButtons","children","radio","removeClass","includes","addClass","html","append","choice","choiceIndex","indexOf","_toggleButton","toggleClass","disabled","deactivate"],"mappings":"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","file":"choice-list.js","sourcesContent":["/* globals $ */\n\nconst ChoiceList = function(options) {\n  this.choiceListId = options.id\n  this.choiceList = $(`#${options.id}`)\n  this.selectedChoices = []\n  this.choices = []\n  this.currentPage = 0\n  this.active = options.active || true\n  this.choiceType = 'single' // default\n}\n\nfunction forEach (iter, proc) {\n  for (let i = 0; i < iter.length; i++)\n    proc(iter[i])\n}\n\nChoiceList.prototype.init = function init (cb) {\n  this.callback = cb\n\n  const self = this\n  const proc = button => button.addEventListener('mousedown', e => self._buttonClickEventListener(self, e))\n  const buttons = document.querySelector(`#${this.choiceListId}`).querySelectorAll('.choice-list-button')\n  if (buttons.forEach)\n    buttons.forEach(proc)\n  else\n    forEach(buttons, proc)\n  return this\n}\n\nChoiceList.prototype._buttonClickEventListener = function _buttonClickEventListener(self, e) {\n    if (!self.active) return\n    const target = $(e.target)\n    if (target.hasClass('submit-choice-list-button')) {\n      // do not submit if at least one choice is not selected\n      if (self.selectedChoices.length === 0) return\n      return self.callback(self.selectedChoices)\n    }\n    if (target.hasClass('choice-list-arrow-up')) {\n      if (self.currentPage === 0) return \n      self.currentPage -= 1\n      self._setupPager(self.currentPage)\n      return self._setupChoices(self.currentPage)\n    }\n    if (target.hasClass('choice-list-arrow-down')) {\n      if (self.currentPage === this.choices.length - 1) return\n      self.currentPage += 1\n      self._setupPager(self.currentPage)\n      return self._setupChoices(self.currentPage)\n    }\n    if (target.hasClass('choice-list-item')) {\n      // if it's not a selectMultiple (choose multiple options) type of choice list,\n      // then deselect the previous choice before selecting the new one\n      if (self.choiceType !== 'selectMultiple') self._deselectChoices()\n      self._toggleChoice(target[0].innerText)\n    }\n\n}\n\nChoiceList.prototype.replaceChoices = function (availableChoices, choiceType = 'single') {\n  this.reset()\n  this.choiceType = choiceType\n  let _choices = [...availableChoices]\n  this.choices = []\n  while (_choices.length > 0) {\n    this.choices.push(_choices.splice(0,4))\n  }\n  this._setupPager(this.currentPage)\n  this._setupChoices(this.currentPage)\n}\n\nChoiceList.prototype._setupPager = function _setupPager (targetPage) {\n  if (this.choices.length == 1) this.choiceList.find('.choice-list-arrows-wrapper').hide()\n  else this.choiceList.find('.choice-list-arrows-wrapper').show()\n\n  if (targetPage === 0) this.choiceList.find('.choice-list-arrow-up').prop('disabled', true)\n  else this.choiceList.find('.choice-list-arrow-up').prop('disabled', false)\n\n  if (targetPage === this.choices.length - 1)\n    this.choiceList.find('.choice-list-arrow-down').prop('disabled', true)\n  else this.choiceList.find('.choice-list-arrow-down').prop('disabled', false)\n\n  this.choiceList.find('.choice-list-pager').text(`${targetPage + 1}/${this.choices.length}`)\n}\n\nChoiceList.prototype._setupChoices = function _setupChoices(page) {\n  const choices = this.choices[page]\n  const choiceButtons = this.choiceList.find('.choice-list-grid-wrapper')[0].children\n  const radio = '<div class=\"choice-list-radio\"><div></div></div>'\n  for (let i = 0; i < choiceButtons.length; i++) {\n    const button = $(choiceButtons[i])\n    button.removeClass('choice-selected')\n    if (choices[i]) {\n      if (this.selectedChoices.includes(choices[i])) button.addClass('choice-selected')\n      button.show()\n      button.html(radio).append($('<div></div>').text(choices[i]))\n      continue\n    }\n    button.hide()\n  }\n}\n \nChoiceList.prototype._toggleChoice = function _toggleChoice(choice) {\n  const choiceIndex = this.selectedChoices.indexOf(choice)\n  if (choiceIndex > -1) {\n    this.selectedChoices.splice(choiceIndex, 1)\n    this._toggleButton(choice)\n    return\n  }\n  this.selectedChoices.push(choice)\n  this._toggleButton(choice)\n}\n\nChoiceList.prototype._toggleButton = function _toggleButton(choice) {\n  const choiceButtons = this.choiceList.find('.choice-list-grid-wrapper')[0].children\n  for (let i = 0; i < choiceButtons.length; i++) {\n    const button = $(choiceButtons[i])\n    if (button[0].innerText === choice) {\n      button.toggleClass('choice-selected')\n      break\n    }\n  }\n  // check if should enable/disable submit button\n  (this.selectedChoices.length === 0) \n\n    ? this.choiceList.find('.submit-choice-list-button')[0].disabled = true\n \n    : this.choiceList.find('.submit-choice-list-button')[0].disabled = false\n  \n}\n\nChoiceList.prototype.deactivate = function deactivate() {\n  this.active = false\n  this.reset()\n}\n\nChoiceList.prototype._deselectChoices = function _deselectChoices() {\n  this.selectedChoices = []\n  const choiceButtons = this.choiceList.find('.choice-list-grid-wrapper')[0].children\n  for (let i = 0; i < choiceButtons.length; i++) {\n    const button = $(choiceButtons[i])\n    button.removeClass('choice-selected')\n  }\n}\n\nChoiceList.prototype.reset = function reset() {\n  this._deselectChoices()\n  this.choiceList.find('.submit-choice-list-button')[0].disabled = true\n  this.choices = []\n  this.currentPage = 0\n  this._setupPager(this.currentPage)\n}\n"]}